{% load static %}
<link rel="stylesheet" href="{% static 'css/style_form.css' %}">
<form id="form_alta_multimedia" method="POST" action="/alta-multimedia/" data-form-id="multimedia">
  {% csrf_token %}
  <div data-block="content" data-form-type="multimedia">
    <div class="row mb-4">
        <div class="col-md-3">
            <label for="profesor" style="font-size: 14px;">Profesor/a <span class="text-danger">*</span></label>
            <input type="text" class="form-control form-control-sm" id="profesor" name="profesor" 
                   required placeholder="Nombre del profesor">
        </div>
        <div class="col-md-3">
            <label for="carrera" style="font-size: 14px;">Carrera <span class="text-danger">*</span></label>
            <select class="form-control form-control-sm" id="carrera" name="carrera" required>
                <option value="">Carrera</option>
                <option value="Profesorado de Educaci√≥n Inicial">Profesorado de Educaci√≥n Inicial</option>
                <option value="Profesorado de Educaci√≥n Primaria">Profesorado de Educaci√≥n Primaria</option>
                <option value="Profesorado de Educaci√≥n Secundaria en Ciencias Pol√≠ticas">Profesorado de Educaci√≥n Secundaria en Ciencias Pol√≠ticas</option>
                <option value="Profesorado de Educaci√≥n Secundaria en Geograf√≠a">Profesorado de Educaci√≥n Secundaria en Geograf√≠a</option>
                <option value="Tecnicatura Superior en Acompa√±amiento Terap√©utico">Tecnicatura Superior en Acompa√±amiento Terap√©utico</option>
                <option value="Tecnicatura Superior en An√°lisis de Sistemas">Tecnicatura Superior en An√°lisis de Sistemas</option>
                <option value="Tecnicatura Superior en Enfermer√≠a">Tecnicatura Superior en Enfermer√≠a</option>
                <option value="Tecnicatura Superior en Higiene y Seguridad en el Trabajo">Tecnicatura Superior en Higiene y Seguridad en el Trabajo</option>
            </select>
        </div>
        <div class="col-md-3">
            <label for="materia" style="font-size: 14px;">Materia <span class="text-danger">*</span></label>
            <select class="form-control form-control-sm" id="materia" name="materia" required>
                <option value="">Primero seleccione una carrera</option>
            </select>
        </div>
    </div>
    <div class="row mb-4">
        <!-- Campos iniciales para URL y t√≠tulo -->
        <div class="col-md-3">
            <label for="ingresar_enlace" style="font-size: 14px;">Ingresar enlace (URL)</label>
            <div class="input-group">
                <input type="url" class="form-control form-control-sm" id="ingresar_enlace" name="ingresar_enlace" placeholder="URL del contenido multimedia">
            </div>
        </div>
        <div class="col-md-6">
            <label for="titulo_contenido" style="font-size: 14px;">Titulo del contenido <span class="text-danger">*</span></label>
            <input type="text" class="form-control form-control-sm" id="titulo_contenido" name="titulo_contenido" required>
        </div>
    </div>
    
    <!-- Input hidden para almacenar los grupos de multimedia -->
    <input type="hidden" id="gruposMultimedia" name="gruposMultimedia" value="">
    
    <!-- Contenedor para mostrar resumen de multimedia agregados (ANTES del bot√≥n +) -->
    <div class="row">
        <div class="col-12">
            <div id="contenedor-tipos-multimedia"></div>
        </div>
    </div>
    
    <!-- Nueva fila para el bot√≥n + centrado con el campo URL (DESPU√âS de los campos din√°micos) -->
    <div class="row mb-4">
        <div class="col-md-3 d-flex justify-content-center">
            <button type="button" class="boton-mas" id="btn-agregar-multimedia" title="Agregar otro contenido multimedia">
                +
            </button>
        </div>
    </div>

    <!-- Contenedor para los ejemplares -->
    <div id="contenedor-ejemplares-multimedia" class="mb-4">
        <!-- Los ejemplares se generar√°n aqu√≠ din√°micamente -->
    </div>
    
    <!-- Botones -->
    <div class="row mt-4">
        <div class="col-12 text-end">
            <a href="{% url 'alta_materiales' %}" class="btn btn-secondary me-2">Cancelar</a>
            <button type="button" class="btn btn-primary" onclick="window.enviarFormularioMultimediaV3()">Guardar</button>
        </div>
    </div>
    <!-- Fin de botones -->
  </div>
</form>
<!-- Importaci√≥n del JS din√°mico de ejemplares -->
<script src="{% static 'js/form_altas.js' %}"></script>

<!-- Script simplificado para funcionalidad multimedia -->
<script>
    // Inicializar gruposTiposMultimedia si no existe
    if (!window.gruposTiposMultimedia) {
        window.gruposTiposMultimedia = [];
    }

    // Funci√≥n para agregar nuevo grupo de multimedia
     function agregarNuevoMultimedia() {
         console.log('Ejecutando agregarNuevoMultimedia()');
         const contenedor = document.getElementById('contenedor-tipos-multimedia');
         console.log('Contenedor encontrado:', contenedor);
         const index = window.gruposTiposMultimedia.length;
         console.log('√çndice actual:', index);
         
         // Crear nuevo grupo
         const nuevoGrupo = {
             url: '',
             titulo: ''
         };
         
         window.gruposTiposMultimedia.push(nuevoGrupo);
         
         // Crear HTML para el nuevo grupo con la estructura exacta especificada
         const grupoHTML = `
             <div class="grupo-multimedia mb-3" data-index="${index}">
                 <div class="row">
                     <div class="col-md-2">
                         <label for="ingresar_enlace_${index}" style="font-size: 14px;">Ingresar enlace (URL)</label>
                         <div class="input-group">
                             <input type="url" class="form-control form-control-sm" 
                                    id="ingresar_enlace_${index}" 
                                    name="ingresar_enlace_${index}" 
                                    placeholder="URL del contenido multimedia">
                         </div>
                     </div>
                     <div class="col-md-4">
                         <label for="titulo_contenido_${index}" style="font-size: 14px;">Titulo del contenido <span class="text-danger">*</span></label>
                         <input type="text" class="form-control form-control-sm" 
                                id="titulo_contenido_${index}" 
                                name="titulo_contenido_${index}" 
                                required>
                     </div>
                     <div class="col-md-2 d-flex align-items-end">
                         <button type="button" class="btn btn-outline-danger btn-sm" 
                                 onclick="eliminarMultimedia(${index})" 
                                 title="Eliminar este contenido multimedia">
                             <i class="fas fa-trash"></i>
                         </button>
                     </div>
                 </div>
             </div>
         `;
         
         contenedor.insertAdjacentHTML('beforeend', grupoHTML);
         console.log('Nuevo grupo agregado exitosamente');
     }

    // Funci√≥n para eliminar grupo de multimedia
    function eliminarMultimedia(index) {
        const grupo = document.querySelector(`[data-index="${index}"]`);
        if (grupo) {
            grupo.remove();
            window.gruposTiposMultimedia.splice(index, 1);
            // Reindexar los elementos restantes
            actualizarIndices();
        }
    }

    // Funci√≥n para actualizar √≠ndices despu√©s de eliminar
     function actualizarIndices() {
         const grupos = document.querySelectorAll('.grupo-multimedia');
         grupos.forEach((grupo, nuevoIndex) => {
             grupo.setAttribute('data-index', nuevoIndex);
             const inputs = grupo.querySelectorAll('input');
             const labels = grupo.querySelectorAll('label');
             
             // Actualizar el input de URL
             inputs[0].id = `ingresar_enlace_${nuevoIndex}`;
             inputs[0].name = `ingresar_enlace_${nuevoIndex}`;
             labels[0].setAttribute('for', `ingresar_enlace_${nuevoIndex}`);
             
             // Actualizar el input de t√≠tulo
             inputs[1].id = `titulo_contenido_${nuevoIndex}`;
             inputs[1].name = `titulo_contenido_${nuevoIndex}`;
             labels[1].setAttribute('for', `titulo_contenido_${nuevoIndex}`);
             
             // Actualizar el bot√≥n de eliminar
             const btnEliminar = grupo.querySelector('button');
             btnEliminar.setAttribute('onclick', `eliminarMultimedia(${nuevoIndex})`);
         });
     }

    // Funci√≥n de inicializaci√≥n
    function inicializarFuncionalidadMultimedia() {
        console.log('üöÄ Inicializando funcionalidad multimedia...');
        // Event listener para el bot√≥n de agregar multimedia
        const btnAgregarMultimedia = document.getElementById('btn-agregar-multimedia');
        console.log('Bot√≥n encontrado:', btnAgregarMultimedia);
        if (btnAgregarMultimedia) {
            btnAgregarMultimedia.addEventListener('click', function() {
                console.log('Bot√≥n clickeado, ejecutando agregarNuevoMultimedia()');
                agregarNuevoMultimedia();
            });
            console.log('Event listener agregado correctamente');
        } else {
            console.error('No se encontr√≥ el bot√≥n btn-agregar-multimedia');
        }
        
        // Configuraci√≥n de carrera-materia
        const carreraSelect = document.getElementById('carrera');
        const materiaSelect = document.getElementById('materia');
        const form = document.getElementById('form_alta_multimedia');
        
        if (carreraSelect && materiaSelect) {
        // Materias por carrera
        const materiasPorCarrera = {
            'Profesorado de Educaci√≥n Inicial': [
                "An√°lisis del Mundo Contempor√°neo",
                "Ateneo de Naturaleza y Sociedad",
                "Ateneo de Matem√°tica",
                "Ateneo de Nuevas Expresiones Est√©ticas",
                "Ateneo de Pr√°cticas del Lenguaje y la Literatura",
                "Corporeidad y Motricidad",
                "Cultura, Comunicaci√≥n y Educaci√≥n",
                "Did√°ctica de la Matem√°tica",
                "Did√°ctica de las Ciencias Naturales",
                "Did√°ctica de las Ciencias Sociales",
                "Did√°ctica de las Pr√°cticas del Lenguaje y la Literatura",
                "Did√°ctica General",
                "Did√°ctica y Curriculum de Nivel Inicial",
                "Dimensi√≥n √âtico-Pol√≠tica de la Praxis Docente",
                "Educaci√≥n en y para la Salud",
                "Educaci√≥n F√≠sica Escolar",
                "Educaci√≥n Musical",
                "Educaci√≥n Pl√°stica",
                "Educaci√≥n Temprana",
                "Filosof√≠a",
                "Historia y Prospectiva de la Educaci√≥n",
                "Juego y Desarrollo Infantil",
                "Medios Audiovisuales, TICs y Educaci√≥n",
                "Pedagog√≠a",
                "Pol√≠tica, Legislaci√≥n y Administraci√≥n del Trabajo Escolar",
                "Pr√°ctica Docente 1",
                "Pr√°ctica Docente 2",
                "Pr√°ctica Docente 3",
                "Pr√°ctica Docente 4",
                "Psicolog√≠a del Desarrollo y el Aprendizaje 1",
                "Psicolog√≠a del Desarrollo y el Aprendizaje 2",
                "Psicolog√≠a Social e Institucional",
                "Reflexi√≥n Filos√≥fica de la Educaci√≥n",
                "Taller de Ciencias Naturales",
                "Taller de Ciencias Sociales",
                "Taller de Definici√≥n Institucional",
                "Taller de Lectura, Escritura y Oralidad (LEO)",
                "Taller de Literatura Infantil",
                "Taller de la Matem√°tica",
                "Taller de Materiales y Objetos L√∫dicos",
                "Taller de Pensamiento L√≥gico Matem√°tico",
                "Teor√≠as Sociopol√≠ticas y Educaci√≥n",
                "Trayectos Formativos Opcionales"
            ],
            'Profesorado de Educaci√≥n Primaria': [
                "An√°lisis del Mundo Contempor√°neo",
                "Arte y Educaci√≥n",
                "Ateneo de Ciencias Naturales",
                "Ateneo de Ciencias Sociales",
                "Ateneo de Matem√°tica",
                "Ateneo de Pr√°cticas del Lenguaje y la Literatura",
                "Configuraciones Culturales del Sujeto Educativo de Primaria",
                "Corporeidad y Motricidad",
                "Cultura, Comunicaci√≥n y Educaci√≥n",
                "Did√°ctica de la Matem√°tica 1",
                "Did√°ctica de la Matem√°tica 2",
                "Did√°ctica de las Ciencias Naturales 1",
                "Did√°ctica de las Ciencias Naturales 2",
                "Did√°ctica de las Ciencias Sociales 1",
                "Did√°ctica de las Ciencias Sociales 2",
                "Did√°ctica de Pr√°cticas del Lenguaje y la Literatura 1",
                "Did√°ctica de Pr√°cticas del Lenguaje y la Literatura 2",
                "Did√°ctica General",
                "Did√°ctica y Curriculum de Nivel Primario",
                "Dimensi√≥n √âtico-Pol√≠tica de la Praxis Docente",
                "Educaci√≥n Art√≠stica",
                "Educaci√≥n F√≠sica Escolar",
                "Filosof√≠a",
                "Historia y Prospectiva de la Educaci√≥n",
                "Medios Audiovisuales, TICs y Educaci√≥n",
                "Pedagog√≠a",
                "Pedagog√≠a Cr√≠tica de las Diferencias",
                "Pol√≠tica, Legislaci√≥n y Administraci√≥n del Trabajo Escolar",
                "Pr√°ctica Docente 1",
                "Pr√°ctica Docente 2",
                "Pr√°ctica Docente 3",
                "Pr√°ctica Docente 4",
                "Psicolog√≠a del Desarrollo y el Aprendizaje 1",
                "Psicolog√≠a del Desarrollo y el Aprendizaje 2",
                "Psicolog√≠a Social e Institucional",
                "Reflexi√≥n Filos√≥fica de la Educaci√≥n",
                "Taller de Definici√≥n Institucional",
                "Taller de Lectura, Escritura y Oralidad (LEO)",
                "Taller de Pensamiento L√≥gico Matem√°tico",
                "Teor√≠as Sociopol√≠ticas y Educaci√≥n",
                "Trayectos Formativos Opcionales"
            ],
            'Profesorado de Educaci√≥n Secundaria en Geograf√≠a': [
                "Antropolog√≠a",
                "Cartograf√≠a",
                "Cartograf√≠a Digital",
                "Cultura Digital y Educaci√≥n",
                "Derechos, Interculturalidad y Ciudadan√≠a",
                "Did√°ctica de la Geograf√≠a",
                "Did√°ctica de las Ciencias Sociales",
                "Did√°ctica y Curriculum",
                "Econom√≠a Pol√≠tica",
                "Educaci√≥n Sexual Integral (ESI)",
                "Educaci√≥n y Transformaciones Sociales Contempor√°neas",
                "Ense√±anza de la Geograf√≠a",
                "Espacio de Opci√≥n Institucional (EOI)",
                "Geograf√≠a Ambiental",
                "Geograf√≠a Ambiental de Am√©rica Latina",
                "Geograf√≠a Ambiental de Argentina",
                "Geograf√≠a Cultural",
                "Geograf√≠a de G√©nero",
                "Geograf√≠a Econ√≥mica y Social Argentina",
                "Geograf√≠a Pol√≠tica y Geopol√≠tica",
                "Geograf√≠a Rural",
                "Geograf√≠a Social",
                "Geograf√≠a Social de Am√©rica Latina",
                "Geograf√≠a Urbana",
                "Historia de los Modelos Econ√≥micos de Argentina",
                "Historia Social General",
                "Introducci√≥n a las Ciencias Sociales y a la Geograf√≠a",
                "Organizaci√≥n Econ√≥mica del Espacio",
                "Pedagog√≠a",
                "Pr√°ctica Docente 1",
                "Pr√°ctica Docente 2",
                "Pr√°ctica Docente 3",
                "Pr√°ctica Docente 4",
                "Problemas Ambientales Locales/Regionales: La Investigaci√≥n en el Aula",
                "Problemas Filos√≥ficos de la Educaci√≥n",
                "Pol√≠tica Educativa Argentina",
                "Psicolog√≠a del Aprendizaje",
                "Reflexi√≥n Filos√≥fico-Pol√≠tica de la Pr√°ctica Docente",
                "Sociolog√≠a",
                "Teor√≠a y Metodolog√≠a en Geograf√≠a",
                "Trayectorias Educativas de J√≥venes y Adultos",
                "Unidades Curriculares Optativas"
            ],
            'Profesorado de Educaci√≥n Secundaria en Ciencias Pol√≠ticas': [
                "An√°lisis de las Instituciones Educativas",
                "Antropolog√≠a",
                "Cultura Digital y Educaci√≥n",
                "Derecho",
                "Derechos Humanos y Ciudadan√≠a",
                "Derechos, Interculturalidad y Ciudadan√≠a",
                "Did√°ctica de la Ciencia Pol√≠tica",
                "Did√°ctica de las Ciencias Sociales",
                "Did√°ctica y Curriculum",
                "Econom√≠a Pol√≠tica",
                "Educaci√≥n y Transformaciones Sociales Contempor√°neas",
                "Educaci√≥n Sexual Integral (ESI)",
                "Espacio de Opci√≥n Institucional (EOI)",
                "Estado, Administraci√≥n y Pol√≠ticas P√∫blicas",
                "Estado y Pol√≠tica de G√©nero",
                "Fundamentos de Ciencia Pol√≠tica",
                "Geograf√≠a",
                "Historia Argentina",
                "Historia Latinoamericana",
                "Historia Mundial",
                "Investigaci√≥n en la Ense√±anza de la Ciencia Pol√≠tica",
                "Opini√≥n P√∫blica, Medios y Pol√≠tica",
                "Pedagog√≠a",
                "Pensamiento Pol√≠tico Pedag√≥gico Latinoamericano",
                "Pol√≠tica Educativa Argentina",
                "Pr√°ctica Docente 1",
                "Pr√°ctica Docente 2",
                "Pr√°ctica Docente 3",
                "Pr√°ctica Docente 4",
                "Problemas Filos√≥ficos de la Educaci√≥n",
                "Problem√°tica y Pol√≠tica Ambiental",
                "Psicolog√≠a del Aprendizaje",
                "Reflexi√≥n Filos√≥fico-Pol√≠tica de la Pr√°ctica Docente",
                "Sistemas Pol√≠ticos Comparados",
                "Sociolog√≠a",
                "Teor√≠a de las Relaciones Internacionales y Pol√≠tica Internacional",
                "Teor√≠a Pol√≠tica 1",
                "Teor√≠a Pol√≠tica 2",
                "Teor√≠a Pol√≠tica 3",
                "Teor√≠a y Derecho Constitucional",
                "Unidades Curriculares Optativas"
            ],
            'Tecnicatura Superior en An√°lisis de Sistemas': [
                "√Ålgebra",
                "Algoritmos y estructuras de datos 1",
                "Algoritmos y estructuras de datos 2",
                "Algoritmos y estructuras de datos 3",
                "An√°lisis Matem√°tico 1",
                "An√°lisis Matem√°tico 2",
                "Arquitectura de Computadores",
                "Aspectos legales de la Profesi√≥n",
                "Base de Datos",
                "Ciencia, Tecnolog√≠a y Sociedad",
                "Estad√≠stica",
                "Ingenier√≠a de Software 1",
                "Ingenier√≠a de Software 2",
                "Ingl√©s 1",
                "Ingl√©s 2",
                "Ingl√©s 3",
                "Pr√°cticas Profesionalizantes 1",
                "Pr√°cticas Profesionalizantes 2",
                "Pr√°cticas Profesionalizantes 3",
                "Redes y Comunicaciones",
                "Seminario de actualizaci√≥n",
                "Sistemas Operativos",
                "Sistemas y Organizaciones"
            ],
            'Tecnicatura Superior en Enfermer√≠a': [
                "Aspectos Bio√©ticos y Legales de la Profesi√≥n",
                "Biolog√≠a Humana",
                "Comunicaci√≥n en Ciencias de la Salud",
                "Condiciones y Medio Ambiente del Trabajo",
                "Cuidados de la Salud Centrados en la Comunidad y la Familia",
                "Enfermer√≠a Comunitaria y Pr√°cticas Educativas en Salud",
                "Enfermer√≠a del Adulto y del Adulto Mayor I",
                "Enfermer√≠a del Adulto y el Adulto Mayor II",
                "Enfermer√≠a en Emergencias y Cat√°strofes",
                "Enfermer√≠a en Salud Mental",
                "Enfermer√≠a Materno Infantil",
                "Farmacolog√≠a en Enfermer√≠a",
                "Fundamentos del Cuidado",
                "Ingl√©s",
                "Introducci√≥n a la Metodolog√≠a de Investigaci√≥n en Salud",
                "Nutrici√≥n y Dietoterapia",
                "Organizaci√≥n y Gesti√≥n de Servicios de Enfermer√≠a",
                "Pr√°cticas Profesionalizantes 1",
                "Pr√°cticas Profesionalizantes 2",
                "Pr√°cticas Profesionalizantes 3",
                "Psicolog√≠a",
                "Salud P√∫blica 1",
                "Salud P√∫blica 2",
                "Teor√≠as Socioculturales de la Salud"
            ],
            'Tecnicatura Superior en Acompa√±amiento Terap√©utico': [
                "Acompa√±amiento Terap√©utico del Adulto y Adulto Mayor",
                "Acompa√±amiento Terap√©utico en la Ni√±ez y Adolescencia",
                "Acompa√±amiento Terap√©utico",
                "Contextualizaci√≥n del Campo Profesional del Acompa√±amiento Terap√©utico",
                "√âtica",
                "Fundamentos de Psicolog√≠a General y de Intervenci√≥n Sociocomunitaria",
                "Ingl√©s",
                "Intervenci√≥n Comunitaria y Recursos Sociales",
                "Investigaci√≥n en Salud",
                "Modalidades de Intervenci√≥n en el Acompa√±amiento Terap√©utico",
                "Modelo de Ocupaci√≥n Humana",
                "Organizaci√≥n y Gesti√≥n de los Servicios de Salud Mental",
                "Pr√°cticas Profesionalizantes I",
                "Pr√°cticas Profesionalizantes II",
                "Pr√°cticas Profesionalizantes III",
                "Principios M√©dicos y de Psicofarmacolog√≠a",
                "Psicofarmacolog√≠a",
                "Psicolog√≠a de los Ciclos Vitales",
                "Psicolog√≠a de Grupos",
                "Psicopatolog√≠a",
                "Salud P√∫blica y Salud Mental",
                "Sistemas Familiares"
            ],
            'Tecnicatura Superior en Higiene y Seguridad en el Trabajo': [
                "Administraci√≥n de las Organizaciones",
                "Capacitaci√≥n de Personal",
                "Comunicaci√≥n y Administraci√≥n de Medios",
                "Control de la Contaminaci√≥n",
                "Derecho del Trabajo",
                "Ergonom√≠a",
                "Estad√≠stica",
                "F√≠sica 1",
                "F√≠sica 2",
                "Higiene Laboral y Medio Ambiente 1",
                "Higiene Laboral y Medio Ambiente 2",
                "Ingl√©s T√©cnico",
                "Medicina del Trabajo 1",
                "Medicina del Trabajo 2",
                "Medios de Representaci√≥n",
                "Pr√°ctica Profesionalizante 1",
                "Pr√°ctica Profesionalizante 2",
                "Pr√°ctica Profesionalizante 3",
                "Psicolog√≠a Laboral",
                "Qu√≠mica 1",
                "Qu√≠mica 2",
                "Seguridad 1",
                "Seguridad 2",
                "Seguridad 3"
            ]
        };
        
        // Funci√≥n para cargar materias
        function cargarMaterias(carreraSeleccionada) {
            materiaSelect.innerHTML = '';
            
            if (carreraSeleccionada && materiasPorCarrera[carreraSeleccionada]) {
                const opcionVacia = document.createElement('option');
                opcionVacia.value = '';
                opcionVacia.textContent = 'Seleccione una materia';
                materiaSelect.appendChild(opcionVacia);
                
                materiasPorCarrera[carreraSeleccionada].forEach(function(materia) {
                    const option = document.createElement('option');
                    option.value = materia;
                    option.textContent = materia;
                    materiaSelect.appendChild(option);
                });
                
                materiaSelect.disabled = false;
            } else {
                const opcionVacia = document.createElement('option');
                opcionVacia.value = '';
                opcionVacia.textContent = 'Primero seleccione una carrera';
                materiaSelect.appendChild(opcionVacia);
                materiaSelect.disabled = true;
            }
        }
        
        // Event listener para cambio de carrera
        carreraSelect.addEventListener('change', function() {
            cargarMaterias(this.value);
        });
        
        // Inicializar estado
        materiaSelect.disabled = true;
        if (carreraSelect.value) {
            cargarMaterias(carreraSelect.value);
        }
        }
    }

    // Funci√≥n para preparar el env√≠o del formulario de multimedia
    window.prepararEnvioFormulario = function() {
        console.log('üì§ Preparando env√≠o del formulario de multimedia...');
        
        // Recopilar datos de multimedia desde los inputs del DOM
        const gruposMultimedia = [];
        
        // Primero, agregar los datos principales del formulario si tienen contenido
        const urlPrincipal = document.getElementById('ingresar_enlace');
        const tituloPrincipal = document.getElementById('titulo_contenido');
        
        if (urlPrincipal && tituloPrincipal && (urlPrincipal.value.trim() || tituloPrincipal.value.trim())) {
            console.log('üìã Agregando datos principales del formulario');
            gruposMultimedia.push({
                url: urlPrincipal.value.trim() || '',
                titulo: tituloPrincipal.value.trim() || ''
            });
        }
        
        // Buscar en el contenedor correcto donde se agregan los elementos din√°micos
        const contenedor = document.getElementById('contenedor-tipos-multimedia');
        
        if (contenedor) {
            const grupos = contenedor.querySelectorAll('.grupo-multimedia');
            console.log(`üì¶ Encontrados ${grupos.length} grupos multimedia din√°micos`);
            console.log('üîç Contenedor HTML:', contenedor.innerHTML);
            
            grupos.forEach((grupo, index) => {
                console.log(`üîç Procesando grupo ${index}:`, grupo);
                
                // Obtener el √≠ndice real del data-index
                const dataIndex = grupo.getAttribute('data-index');
                console.log(`üìä Data-index del grupo: ${dataIndex}`);
                
                const urlInput = grupo.querySelector(`input[name="ingresar_enlace_${dataIndex}"]`);
                const tituloInput = grupo.querySelector(`input[name="titulo_contenido_${dataIndex}"]`);
                
                console.log(`üìã Grupo din√°mico ${index} (data-index: ${dataIndex}):`, {
                    urlInput: urlInput ? urlInput.value : 'no encontrado',
                    tituloInput: tituloInput ? tituloInput.value : 'no encontrado',
                    urlSelector: `input[name="ingresar_enlace_${dataIndex}"]`,
                    tituloSelector: `input[name="titulo_contenido_${dataIndex}"]`
                });
                
                if (urlInput && tituloInput && (urlInput.value.trim() || tituloInput.value.trim())) {
                    gruposMultimedia.push({
                        url: urlInput.value.trim() || '',
                        titulo: tituloInput.value.trim() || ''
                    });
                    console.log(`‚úÖ Datos agregados del grupo ${dataIndex}`);
                } else {
                    console.log(`‚ùå No se agregaron datos del grupo ${dataIndex} - campos vac√≠os o no encontrados`);
                }
            });
        } else {
            console.log('‚ùå No se encontr√≥ el contenedor contenedor-tipos-multimedia');
        }
        
        // Actualizar window.gruposTiposMultimedia
        window.gruposTiposMultimedia = gruposMultimedia;
        
        // Serializar los datos si existe el input hidden
        const gruposTiposMultimediaInput = document.getElementById('gruposMultimedia');
        if (gruposTiposMultimediaInput) {
            gruposTiposMultimediaInput.value = JSON.stringify(window.gruposTiposMultimedia);
            console.log('üì§ Datos serializados en input hidden:', gruposTiposMultimediaInput.value);
        } else {
            console.log('‚ùå No se encontr√≥ el input hidden gruposMultimedia');
        }
        
        console.log('üì§ Datos de multimedia preparados:', {
            gruposTiposMultimedia: window.gruposTiposMultimedia,
            totalElementos: gruposMultimedia.length
        });
    }

    // Funci√≥n local eliminada - ahora se usa la funci√≥n global enviarFormularioMultimediaV2
    
    // Inicializar cuando el DOM est√© listo
    document.addEventListener('DOMContentLoaded', function() {
        console.log('üìÑ DOM Content Loaded - Ejecutando inicializaci√≥n multimedia');
        inicializarFuncionalidadMultimedia();
    });
</script>
</form>