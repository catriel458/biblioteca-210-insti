{% load static %}
<link rel="stylesheet" href="{% static 'css/style_form.css' %}">
<form id="form_alta_multimedia" method="POST" action="/alta-multimedia/" data-form-id="multimedia">
  {% csrf_token %}
  <div data-block="content" data-form-type="multimedia">
    <div class="row mb-4">
        <div class="col-md-3">
            <label for="profesor" style="font-size: 14px;">Profesor/a <span class="text-danger">*</span></label>
            <input type="text" class="form-control form-control-sm" id="profesor" name="profesor" 
                   required placeholder="Nombre del profesor">
        </div>
        <div class="col-md-3">
            <label for="carrera" style="font-size: 14px;">Carrera <span class="text-danger">*</span></label>
            <select class="form-control form-control-sm" id="carrera" name="carrera" required>
                <option value="">Carrera</option>
                <option value="Profesorado de Educación Inicial">Profesorado de Educación Inicial</option>
                <option value="Profesorado de Educación Primaria">Profesorado de Educación Primaria</option>
                <option value="Profesorado de Educación Secundaria en Ciencias Políticas">Profesorado de Educación Secundaria en Ciencias Políticas</option>
                <option value="Profesorado de Educación Secundaria en Geografía">Profesorado de Educación Secundaria en Geografía</option>
                <option value="Tecnicatura en Acompañamiento Terapéutico">Tecnicatura en Acompañamiento Terapéutico</option>
                <option value="Tecnicatura Superior en Análisis de Sistemas">Tecnicatura Superior en Análisis de Sistemas</option>
                <option value="Tecnicatura en Enfermería">Tecnicatura en Enfermería</option>
                <option value="Tecnicatura Superior en Higiene y Seguridad en el Trabajo">Tecnicatura Superior en Higiene y Seguridad en el Trabajo</option>
            </select>
        </div>
        <div class="col-md-3">
            <label for="materia" style="font-size: 14px;">Materia <span class="text-danger">*</span></label>
            <select class="form-control form-control-sm" id="materia" name="materia" required>
                <option value="">Primero seleccione una carrera</option>
            </select>
        </div>
    </div>
    <div class="row mb-4">
        <!-- Campos iniciales para URL y título -->
        <div class="col-md-3">
            <label for="ingresar_enlace" style="font-size: 14px;">Ingresar enlace (URL)</label>
            <div class="input-group">
                <input type="url" class="form-control form-control-sm" id="ingresar_enlace" name="ingresar_enlace" placeholder="URL del contenido multimedia">
            </div>
        </div>
        <div class="col-md-3">
            <label for="titulo_contenido" style="font-size: 14px;">Titulo del contenido <span class="text-danger">*</span></label>
            <input type="text" class="form-control form-control-sm" id="titulo_contenido" name="titulo_contenido" required>
        </div>
        <div class="col-md-1 d-flex align-items-end">
            <button type="button" class="boton-mas" id="btn-agregar-multimedia" title="Agregar otro contenido multimedia">
                +
            </button>
        </div>
        
        <!-- Botón para agregar multimedia -->
        <div class="col-12 mb-3">
            <button type="button" id="btn-agregar-multimedia" class="btn btn-success" onclick="agregarNuevoMultimedia()">
                <i class="fas fa-plus"></i> Agregar Multimedia
            </button>
        </div>
        
        <!-- Contenedor dinámico para multimedia -->
        <div id="multimedia-container">
            <!-- Los campos dinámicos se agregarán aquí -->
        </div>
    
    <!-- Botones -->
    <div class="row mt-4">
        <div class="col-12 text-end">
            <a href="{% url 'alta_materiales' %}" class="btn btn-secondary me-2">Cancelar</a>
            <!-- Campo oculto para contar multimedia dinámicos -->
                <input type="hidden" id="cant_multimedia" name="cant_multimedia" value="0">
                
                <button type="button" class="btn btn-primary" onclick="enviarFormulario()">Guardar</button>
        </div>
    </div>
    <!-- Fin de botones -->
  </div>
</form>
<!-- Importación del JS dinámico de ejemplares -->
<script src="{% static 'js/form_altas.js' %}"></script>

<script>
    let contadorMultimedia = 0;

    function agregarNuevoMultimedia() {
        contadorMultimedia++;
        
        const contenedor = document.getElementById('multimedia-container');
        const nuevoGrupo = document.createElement('div');
        nuevoGrupo.className = 'multimedia-grupo mb-3 p-3 border rounded';
        nuevoGrupo.id = `multimedia-grupo-${contadorMultimedia}`;
        
        nuevoGrupo.innerHTML = `
            <div class="row">
                <div class="col-md-6">
                    <label for="url_${contadorMultimedia}" class="form-label">Ingresar enlace (URL)</label>
                    <input type="url" class="form-control" id="url_${contadorMultimedia}" name="url_${contadorMultimedia}" required>
                </div>
                <div class="col-md-5">
                    <label for="titulo_${contadorMultimedia}" class="form-label">Título del contenido</label>
                    <input type="text" class="form-control" id="titulo_${contadorMultimedia}" name="titulo_${contadorMultimedia}" required>
                </div>
                <div class="col-md-1 d-flex align-items-end">
                    <button type="button" class="btn btn-danger btn-sm" onclick="eliminarMultimedia(${contadorMultimedia})">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
        `;
        
        contenedor.appendChild(nuevoGrupo);
        
        // Actualizar contador
        document.getElementById('cant_multimedia').value = contadorMultimedia;
    }

    function eliminarMultimedia(id) {
        const grupo = document.getElementById(`multimedia-grupo-${id}`);
        if (grupo) {
            grupo.remove();
        }
    }

    function enviarFormulario() {
        // Aquí puedes agregar validaciones adicionales si es necesario
        document.getElementById('form_alta_multimedia').submit();
    }

    // Inicializar cuando el DOM esté listo
    document.addEventListener('DOMContentLoaded', function() {
        // Configuración de carrera-materia
        const carreraSelect = document.getElementById('carrera');
        const materiaSelect = document.getElementById('materia');
        
        if (carreraSelect && materiaSelect) {
            // Materias por carrera
            const materiasPorCarrera = {
                'Profesorado de Educación Inicial': [
                    'Pedagogía', 'Psicología Educacional', 'Sociología de la Educación', 
                    'Historia y Política de la Educación Argentina', 'Filosofía de la Educación',
                    'Didáctica General', 'Curriculum y Didáctica del Nivel Inicial', 
                    'Juego y Desarrollo Infantil', 'Literatura Infantil', 'Matemática y su Didáctica',
                    'Ciencias Sociales y su Didáctica', 'Ciencias Naturales y su Didáctica',
                    'Lengua y su Didáctica', 'Educación Artística', 'Educación Física',
                    'Práctica Docente I', 'Práctica Docente II', 'Práctica Docente III', 'Práctica Docente IV'
                ],
                'Profesorado de Educación Primaria': [
                    'Pedagogía', 'Psicología Educacional', 'Sociología de la Educación',
                    'Historia y Política de la Educación Argentina', 'Filosofía de la Educación',
                    'Didáctica General', 'Curriculum y Didáctica del Nivel Primario',
                    'Matemática y su Didáctica I', 'Matemática y su Didáctica II',
                    'Lengua y su Didáctica I', 'Lengua y su Didáctica II',
                    'Ciencias Sociales y su Didáctica I', 'Ciencias Sociales y su Didáctica II',
                    'Ciencias Naturales y su Didáctica I', 'Ciencias Naturales y su Didáctica II',
                    'Educación Artística', 'Educación Física', 'Tecnologías de la Información',
                    'Práctica Docente I', 'Práctica Docente II', 'Práctica Docente III', 'Práctica Docente IV'
                ],
                'Profesorado de Educación Secundaria en Geografía': [
                    'Pedagogía', 'Psicología Educacional', 'Sociología de la Educación',
                    'Historia y Política de la Educación Argentina', 'Filosofía de la Educación',
                    'Didáctica General', 'Didáctica de la Geografía',
                    'Geografía Física I', 'Geografía Física II', 'Geografía Humana I', 'Geografía Humana II',
                    'Geografía de América', 'Geografía de Argentina', 'Geografía Mundial',
                    'Cartografía', 'Climatología', 'Geomorfología', 'Biogeografía',
                    'Geografía Económica', 'Geografía Urbana y Rural', 'Epistemología de la Geografía',
                    'Práctica Docente I', 'Práctica Docente II', 'Práctica Docente III', 'Práctica Docente IV'
                ],
                'Profesorado de Educación Secundaria en Ciencias Políticas': [
                    'Pedagogía', 'Psicología Educacional', 'Sociología de la Educación',
                    'Historia y Política de la Educación Argentina', 'Filosofía de la Educación',
                    'Didáctica General', 'Didáctica de las Ciencias Políticas',
                    'Teoría Política', 'Historia del Pensamiento Político', 'Sistemas Políticos Comparados',
                    'Política Argentina', 'Política Latinoamericana', 'Relaciones Internacionales',
                    'Derecho Constitucional', 'Sociología Política', 'Economía Política',
                    'Filosofía Política', 'Metodología de la Investigación Social',
                    'Práctica Docente I', 'Práctica Docente II', 'Práctica Docente III', 'Práctica Docente IV'
                ],
                'Tecnicatura Superior en Análisis de Sistemas': [
                    'Matemática', 'Inglés Técnico', 'Arquitectura de Computadoras',
                    'Sistemas Operativos', 'Algoritmos y Estructuras de Datos',
                    'Programación I', 'Programación II', 'Programación III',
                    'Base de Datos I', 'Base de Datos II', 'Análisis de Sistemas I', 'Análisis de Sistemas II',
                    'Ingeniería de Software', 'Redes y Comunicaciones', 'Seguridad Informática',
                    'Desarrollo Web', 'Programación Orientada a Objetos', 'Metodologías de Desarrollo',
                    'Gestión de Proyectos', 'Práctica Profesionalizante I', 'Práctica Profesionalizante II'
                ],
                'Tecnicatura en Enfermería': [
                    'Anatomía y Fisiología I', 'Anatomía y Fisiología II', 'Microbiología y Parasitología',
                    'Farmacología', 'Patología', 'Nutrición y Dietoterapia',
                    'Enfermería Básica', 'Enfermería Médica', 'Enfermería Quirúrgica',
                    'Enfermería Materno Infantil', 'Enfermería Pediátrica', 'Enfermería Geriátrica',
                    'Enfermería en Salud Mental', 'Enfermería Comunitaria', 'Administración en Enfermería',
                    'Bioética', 'Epidemiología', 'Primeros Auxilios',
                    'Práctica Profesional I', 'Práctica Profesional II', 'Práctica Profesional III'
                ],
                'Tecnicatura en Acompañamiento Terapéutico': [
                    'Psicología General', 'Psicopatología', 'Neurociencias', 'Desarrollo Humano',
                    'Teorías y Técnicas de Acompañamiento Terapéutico', 'Comunicación Terapéutica',
                    'Dinámicas Familiares', 'Integración Social', 'Recreación Terapéutica',
                    'Talleres de Expresión', 'Primeros Auxilios', 'Bioética',
                    'Legislación en Salud Mental', 'Trabajo Interdisciplinario',
                    'Práctica Profesional I', 'Práctica Profesional II', 'Práctica Profesional III'
                ],
                'Tecnicatura Superior en Higiene y Seguridad en el Trabajo': [
                    'Matemática', 'Física', 'Química', 'Legislación Laboral',
                    'Higiene Industrial I', 'Higiene Industrial II', 'Seguridad Industrial I', 'Seguridad Industrial II',
                    'Medicina del Trabajo', 'Toxicología Laboral', 'Ergonomía',
                    'Protección contra Incendios', 'Contaminación Ambiental', 'Gestión de Residuos',
                    'Capacitación en Seguridad', 'Investigación de Accidentes', 'Auditorías de Seguridad',
                    'Gestión de Riesgos', 'Práctica Profesional I', 'Práctica Profesional II'
                ]
            };
            
            // Función para cargar materias
            function cargarMaterias(carreraSeleccionada) {
                materiaSelect.innerHTML = '';
                
                if (carreraSeleccionada && materiasPorCarrera[carreraSeleccionada]) {
                    const opcionVacia = document.createElement('option');
                    opcionVacia.value = '';
                    opcionVacia.textContent = 'Seleccione una materia';
                    materiaSelect.appendChild(opcionVacia);
                    
                    materiasPorCarrera[carreraSeleccionada].forEach(function(materia) {
                        const option = document.createElement('option');
                        option.value = materia;
                        option.textContent = materia;
                        materiaSelect.appendChild(option);
                    });
                    
                    materiaSelect.disabled = false;
                } else {
                    const opcionVacia = document.createElement('option');
                    opcionVacia.value = '';
                    opcionVacia.textContent = 'Primero seleccione una carrera';
                    materiaSelect.appendChild(opcionVacia);
                    materiaSelect.disabled = true;
                }
            }
            
            // Event listener para cambio de carrera
            carreraSelect.addEventListener('change', function() {
                cargarMaterias(this.value);
            });
            
            // Inicializar estado
            materiaSelect.disabled = true;
            if (carreraSelect.value) {
                cargarMaterias(carreraSelect.value);
            }
        }
    });
</script>