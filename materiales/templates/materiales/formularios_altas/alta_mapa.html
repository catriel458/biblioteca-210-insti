{% load static %}

<div data-block="content" data-form="mapa">
    <div class="row mb-3">
        <div class="col-md-4">
            <label for="sede">Sede: <span style="color: red;">*</span></label>
            <select class="form-select select-sede" id="sede-mapa" name="sede_mapa" required>
                <option value="">Seleccione una sede</option>
                <option value="sede1">La Plata</option>
                <option value="sede2">Abasto</option>
            </select>
        </div>

        <div class="col-md-4">
            <label for="input-nuevo-tipo-mapa">Tipo de Mapa: <span style="color: red;">*</span></label>
            <select class="form-select select-sede" id="input-nuevo-tipo-mapa" required>
                <option value="">Seleccione un tipo</option>
                <option value="FISICO">FISICO</option>
                <option value="FISICO-POLITICO">FISICO-POLITICO</option>
                <option value="POLITICO">POLITICO</option>
                <option value="OTROS">OTROS</option>
            </select>
        </div>
        
        <div class="col-md-4">
            <label for="input-nueva-cant-mapa" class="form-label small">Cantidad <span class="text-danger">*</span></label>
            <input type="number" class="form-control form-control-sm" id="input-nueva-cant-mapa" name="cantidad_mapa" min="1" value="1" required>
        </div>
    </div>
    

    
    <!-- Contenedor dinámico para tipo y cantidad -->
    <div class="row mb-3">
        <div class="col-4" id="bloque-tipo-cantidad"></div>
    </div>

    <!-- Contenedor para los ejemplares -->
    <div id="contenedor-ejemplares-mapa" class="mb-4">
        <!-- Los ejemplares se generarán aquí dinámicamente -->
    </div>
    
    <!-- Botones -->
    <div class="row" style="margin-bottom: 120px;">
        <div class="col-12 d-flex justify-content-end gap-3">
            <button type="reset" class="btn btn-outline-danger btn-sm">Cancelar</button>
            <button type="submit" class="btn btn-primary btn-sm" formaction="{% url 'confirmar_alta_mapa' %}" formmethod="post">Guardar</button>
        </div>
    </div>
</div>

<style>
/* Asegurar que los botones no queden ocultos detrás del footer */
.content {
    padding-bottom: 100px !important;
}

/* Estilo específico para el contenedor de botones del formulario de mapas */
[data-form="mapa"] .row:last-of-type {
    margin-bottom: 120px !important;
    padding-bottom: 20px;
}

/* Asegurar que el contenedor de ejemplares tenga espacio suficiente */
#contenedor-ejemplares-mapa {
    margin-bottom: 20px;
}
</style>

<!-- Importación del JS dinámico de ejemplares -->
<script src="{% static 'js/form_altas.js' %}"></script>
<script src="{% static 'js/form_controller.js' %}"></script>

<script>
    // Inicializar gruposTiposMapa si no existe
    if (!window.gruposTiposMapa) {
        window.gruposTiposMapa = [];
    }
    
    // Llamar a la función de renderizado
    window.renderizarTiposMapa();
    
    // Actualizar el input de sede cuando se seleccione un tipo de mapa
    document.getElementById('input-nuevo-tipo-mapa').addEventListener('change', function() {
        const sedeInput = document.getElementById('sede-mapa');
        const tipoSeleccionado = this.value;
        if (tipoSeleccionado) {
            sedeInput.value = tipoSeleccionado;
        } else {
            sedeInput.value = '';
        }
    });
</script>