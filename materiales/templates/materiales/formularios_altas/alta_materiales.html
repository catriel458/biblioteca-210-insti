{% extends 'components/baseb.html' %}
{% load static %}
{% block extra_styles %}
    <link rel="stylesheet" href="{% static 'css/manual_modal.css' %}">
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    <link rel="stylesheet" href="{% static 'css/style_form.css' %}">
    <link rel="stylesheet" href="{% static 'css/botones.css' %}">
{% endblock %}

{% block content %}
<div class="container-fluid">
    <form id="form_alta_material" action="{% url 'alta_libro' %}" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="row align-items-start">
            <div class="col-12 col-lg-10">
                <div class="row">
                    <div class="col-12 col-sm-6 col-lg-2 form-group mb-2">
                        <label for="tipo_material" class="text-input" style="color:#25898D;">Tipo de Material:</label>
                        <select class="form-control form-control-sm" id="tipo_material" name="tipo_material" required>
                            <option value="">Selecciona un tipo de material</option>
                            <option value="libro">LIBRO</option>
                            <option value="mapa">MAPA</option>
                            <option value="multimedia">MULTIMEDIA</option>
                            <option value="notebook">NOTEBOOK</option>
                            <option value="programa">PROGRAMA</option>
                            <option value="proyector">PROYECTOR</option>
                            <option value="varios">VARIOS</option>
                        </select>
                    </div>
                    <div class="col-12 col-lg-8 mb-2"></div>
                </div>
                <!-- Aquí se cargará dinámicamente el formulario -->
                <div id="formulario-especifico" class="mt-2 row"></div>
            </div>
            <!-- Columna derecha con manual y carga masiva si querés la mantenés aquí -->
            <div class="col-12 col-lg-2 d-flex flex-column align-items-end mt-3 mt-lg-0">
                <div class="w-100 mb-2">
                    <button type="button" class="btn btn-dark btn-sm manual-button w-100" onclick="document.getElementById('manualModal').style.display='flex'">MANUAL</button>
                </div>
            </div>
        </div>

        <!-- Botones -->
        <div id="buttons-container" class="row bg-white px-0 mx-0" style="border:none; box-shadow:none; display: none;">
            <div class="col-12 d-flex justify-content-end gap-5">
                <button type="button" class="btn btn-outline-danger btn-sm boton-cancelar">Cancelar</button>
                <button type="submit" class="btn btn-primary btn-sm boton-guardar">Guardar</button>
            </div>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
document.addEventListener("DOMContentLoaded", function () {
    const tipoMaterial = document.getElementById('tipo_material');
    const formularioEspecifico = document.getElementById('formulario-especifico');
    const buttonsContainer = document.getElementById('buttons-container');

    tipoMaterial.addEventListener('change', function () {
        const tipo = this.value;
        if (tipo === 'libro') {
            fetch('/materiales/formulario/libro/')
                .then(response => {
                    if (!response.ok) throw new Error('No se pudo cargar el formulario.');
                    return response.text();
                })
                .then(html => {
                    formularioEspecifico.innerHTML = html;
                    buttonsContainer.style.display = 'flex';
                })
                .catch(error => {
                    formularioEspecifico.innerHTML = `<p class="text-danger">Error al cargar el formulario: ${error.message}</p>`;
                    buttonsContainer.style.display = 'none';
                });
        } else {
            formularioEspecifico.innerHTML = '';
            buttonsContainer.style.display = 'none';
        }
    });
});
</script>
{% endblock %}
